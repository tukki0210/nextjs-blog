---
title: '【HandsOnJS】気象庁のAPIから天気予報データを取得する'
date: '2021-06-16'
image: '/images/2021年/5月/HandsOnJS.jpg'
---

## とりあえずfetchとasyncとawaitを使ってみる。
APIとはサーバーからhtmlやcss、JavaScriptを取得するのではなく、データのみを取得する方法です。<br/>
細かい話は置いといて、気象庁のAPIを叩いて天気予報のデータを取得してみます。<br/>
(実際は公式のAPIサービスというわけではなく、リクエストしたらJSONデータが取得できる状態だそうです。)<br/>


JavaScriptでAPIからデータを取得するには、<code>fetch</code>メソッドを利用します。

また、これに限らず外部サーバーからデータを取得する際は、<strong>非同期処理</strong>というものが一般に使われます。
JavaScriptで非同期処理を実現する方法がいくつか存在しますが、最新の<code>async/awiat</code> を使用して
記載してみます。なお、読み方は「エィシンク・アウェイト」です。

```html
<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
</body>
<script>
    // API配信のURL
    // 130000は東京のエリアコード
    let url_Tokyo = "https://www.jma.go.jp/bosai/forecast/data/overview_forecast/130000.json"

    async function getWeather(url) {
        // 指定したurlのAPIからjsonデータを取得
        const response = await fetch(url)
        // jsonデータをオブジェクトに変換する
        const data = await response.json()
        // オブジェクトの中からkeyがtextのvalueを取得する
        const text = data.text

        console.log(text)
    }
    // 関数の実行
    getWeather(url_Tokyo)
</script>

</html>
```

下記のような天気予報の概要が取得できます。現在は梅雨です。

```console
 前線が、華中から東シナ海を通って日本の南へのびています。また、前線上の九州付近には低気圧があって、東南東へ進んでいます。

　東京地方は、曇りや雨となっています。

　１６日は、上空の寒気や湿った空気の影響により、雨で時々曇りとなり、昼過ぎから夜のはじめ頃にかけて雷を伴い激しく降る所があるでしょう。伊豆諸島では、曇りや雨で、夜は雷を伴い激しく降る所がある見込みです。

　１７日は、上空の寒気や湿った空気の影響により、曇りで昼前まで時々雨となるでしょう。

【関東甲信地方】
　関東甲信地方は、曇りや雨で、雷を伴い激しい雨の降っている所があります。

　１６日は、上空の寒気や湿った空気の影響により、曇りや雨で、雷を伴い激しく降る所があるでしょう。

　１７日は、上空の寒気や湿った空気の影響により、曇りや雨で、雷を伴う所がある見込みです。

　関東地方と伊豆諸島の海上では、１６日は波がやや高く、１７日はうねりを伴い波が高いでしょう。また、所々で霧が発生しています。船舶は高波や視程障害に注意してください。
```


## 非同期処理について

### Promise

### async/await

参考<br/>
[気象庁の天気予報JSONファイルをWebAPI的に利用したサンプルアプリ](https://anko.education/apps/weather_api)<br/>
[新しい気象庁サイトからJSONデータが取得できる件](https://mindtech.jp/?p=1754)<br/>
