---
title: '【Laravel9×Vue3】本の貸し出しシステムを作る3（書籍の追加機能）'
date: '2023-01-30'
image: '/images/2023年/1月/LaravelVue.jpg'
metaDescription: Laravelでシステムの実装の練習
tags:
  - 'Laravel'
  - 'Vue'
  - '環境構築'
---

##  LaravelのAPIにpostメソッドでデータを送信する

<red><bold>Restful API</bold></red>は、同じURIに異なる<red><bold>HTTP メソッド</bold></red> でアクセスすることで、

そのHTTPメソッドに対応した動作をサーバー側に行わさせる仕組みです。

データをサーバー側に送信したい場合は、<bold>POST</bold>メソッドによってアクセスを行います。

## バックエンド側（Laravel）の設定
ルーティングの設定(api.web)は設定が終わっていますが再掲します。

この１行で、Restful API に対応したコントローラが呼び出すことができます。

#### ルーティングの確認

```teminal
php artisan route:list
```

```GET|HEAD        / ......................................................................................... 
  POST            _ignition/execute-solution ignition.executeSolution › Spatie\LaravelIgnition › ExecuteSolu…
  GET|HEAD        _ignition/health-check ignition.healthCheck › Spatie\LaravelIgnition › HealthCheckControll…
  POST            _ignition/update-config ignition.updateConfig › Spatie\LaravelIgnition › UpdateConfigContr…
  GET|HEAD        api/books .............................................. books.index › BookController@index
  POST            api/books .............................................. books.store › BookController@store
  GET|HEAD        api/books/{book} ......................................... books.show › BookController@show
  PUT|PATCH       api/books/{book} ..................................... books.update › BookController@update
  DELETE          api/books/{book} ................................... books.destroy › BookController@destroy
  GET|HEAD        api/user .................................................................................. 
  GET|HEAD        sanctum/csrf-cookie ..... sanctum.csrf-cookie › Laravel\Sanctum › CsrfCookieController@show
```
## コントローラに追加する

上記のルーティングテーブルを見ると、<red>api/books</red>に<bold>POST</bold>でアクセスした場合、bookControllerの<bold>storeアクション</bold>が呼び出されるとされています。

このstoreアクションに、受け取ったデータをデータベースに渡して保存できるようにしました。（本来はセキュリティ対策や入力されるデータの確認のためにバリデーション等が必要です。）


#### BookController
```php
// 中略

    public function store(Request $request)
    {
        // モデルの空のインスタンスを生成
        $book = new Book();

        // 受け取ったデータをインスタンスに挿入し、DBに保存
        $book->fill($request->all())->save();
    }
```


これでデータを受け取る側の設定は完了です。

## フロントエンド側(Vue)の設定

データを送るためのコンポーネントとして<bold>BookAdd.vue</bold>を作成します。

#### BookAdd.vue
```javascript
<template>
    <form>
        <label for="title">タイトル</label>
        <input type="text" id="title" v-model="book.title"/>
        <br />
        <button v-on:click="send">送信</button>
    </form>
    <h5>v-modelの動作確認</h5>
    <div>{{ book.title }}</div>
</template>

<script>

import axios from "axios";

export default {
  name: "BookAdd",
  data(){
    return {
        book:{
            title:"",
        }
    }
  },

  methods:{
    async send(){
        const url = "/api/books";
        const response = await axios.post(url,this.book);
        console.log(response)
    }
        
    }
};
</script>
```